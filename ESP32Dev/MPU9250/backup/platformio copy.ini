; PlatformIO Project Configuration File
;
; Serial port가 안될 때 테스트 용도로 사용
; 
; Arduino Nano ESP32 부트로더 진입 방법 (수정)
; Arduino Nano ESP32는 BOOT0 버튼 하나만 있습니다.

; 방법 2: 더블탭 부트로더 (권장)

; BOOT0 버튼을 빠르게 두 번 누르기 (더블클릭)
; 보드의 LED가 천천히 깜빡이면 부트로더 모드 진입 성공
; 업로드 실행

; 방법 3: 업로드 시작과 동시에

; 업로드 명령 실행
; "Connecting..." 메시지가 나타나면 즉시 BOOT0 버튼 누르기
; 연결될 때까지 계속 누르고 있기

[env:arduino_nano_esp32]
platform = espressif32
board = arduino_nano_esp32
framework = arduino

; [env:esp32dev]
; platform = espressif32
; board = esp32dev          ; 일반 ESP32-DevKit(WROOM-32) 보드
; framework = arduino

; 업로드 설정 (속도 낮춤)
upload_protocol = esptool
upload_speed = 115200       ; ✅ 안정성을 위해 낮춤
; upload_port = COM5          ; ✅ 자동 감지된 포트
upload_flags = 
    --before=default_reset
    --after=hard_reset

build_flags = 
  -DCORE_DEBUG_LEVEL=5
  -DARDUINO_USB_CDC_ON_BOOT=1

; ✅ 파티션 테이블 명시 (기본 파티션 사용)
board_build.partitions = default.csv

; 시리얼 모니터 설정
monitor_speed = 115200
; monitor_port = COM7         ; ✅ COM7로 변경
monitor_filters = esp32_exception_decoder, colorize
monitor_rts = 0
monitor_dtr = 0

; 디버그 모드
build_type = debug

; ===== 사용 명령어 =====
; 수동 부트 모드로 업로드:
; 1. pio run -t upload 실행
; 2. BOOT 버튼 누른 채로 RST 버튼 누르고 뗌
; 3. "Connecting..." 나타나면 BOOT 버튼 뗌
;
; 모니터 시작:
; pio run -e arduino_nano_esp32 -t upload && pio device monitor


; ===== 문제 해결 순서 =====
; 1. pio run -t erase          # 플래시 완전 삭제
; 2. pio run -t upload         # 재업로드
; 3. pio device monitor        # 모니터 시작